<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XCECUTIVEFIVEID Community Hub</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for easier customization */
        :root {
            --neon-blue: #00FFFF;
            --neon-purple: #8A2BE2;
            --dark-background: #000;
            --dark-overlay: rgba(0, 0, 0, 0.85);
            --text-color: #e0e0e0;
            --error-color: #FF69B4;
            --glitch-color1: var(--neon-blue);
            --glitch-color2: var(--neon-purple);
        }

        /* --- Animations --- */
        @keyframes backgroundPan {
            0% { background-position: 0% 0%, 100% 100%, 0% 0%; }
            50% { background-position: 20% 10%, 80% 90%, 10% 20%; }
            100% { background-position: 0% 0%, 100% 100%, 0% 0%; }
        }

        @keyframes fadeInPopUp {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes pulseBorder {
            0% { box-shadow: 0 0 5px var(--neon-blue); }
            50% { box-shadow: 0 0 20px var(--neon-blue); }
            100% { box-shadow: 0 0 5px var(--neon-blue); }
        }

        @keyframes glitch {
            0% { text-shadow: 2px 2px var(--glitch-color2), -2px -2px var(--glitch-color1); }
            20% { text-shadow: -2px -2px var(--glitch-color2), 2px 2px var(--glitch-color1); }
            40% { text-shadow: 3px 3px var(--glitch-color2), -3px -3px var(--glitch-color1); }
            60% { text-shadow: -3px 3px var(--glitch-color2), 3px -3px var(--glitch-color1); }
            80% { text-shadow: 4px -4px var(--glitch-color2), -4px 4px var(--glitch-color1); }
            100% { text-shadow: 2px 2px var(--glitch-color2), -2px -2px var(--glitch-color1); }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Broadcast Text Animation */
        @keyframes marquee {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        .broadcast-content {
         /* ... kode lainnya ... */
            animation: marquee 20s linear infinite; /* Bagian ini yang perlu Anda sesuaikan */
        }
        /* --- General Styles --- */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-background);
            background-image: radial-gradient(at 80% 0%, hsla(218,100%,70%,0.1) 0px, transparent 50%),
                                  radial-gradient(at 0% 100%, hsla(280,100%,80%,0.1) 0px, transparent 50%),
                                  linear-gradient(to bottom right, #111, #222);
            background-repeat: no-repeat;
            background-attachment: fixed;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.5s ease;
            animation: backgroundPan 60s linear infinite alternate;
        }
        .main-content-wrapper, .main-menu-wrapper {
            width: 100%;
            max-width: 700px;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: var(--dark-overlay);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 15px var(--neon-blue), 0 0 0 1px rgba(0, 255, 255, 0.08) inset;
            border: 1px solid rgba(0, 255, 255, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }
        .container:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.2), 0 0 0 1px rgba(0, 255, 255, 0.15) inset;
        }
        .animate-initial-load {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            animation: fadeInPopUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        .hidden { display: none; }

        /* --- UI Elements --- */
        h1, h2, h3 {
            color: var(--neon-blue);
            text-shadow: 0 0 5px var(--neon-blue), 0 0 10px var(--neon-purple);
        }
        .glitch-text {
            animation: glitch 1.5s linear infinite;
        }
        p, li {
            color: var(--text-color);
        }
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 14px;
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.6);
            box-shadow: 0 0 5px var(--neon-blue), inset 0 0 5px var(--neon-blue);
        }
        .btn:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 0 15px var(--neon-blue), inset 0 0 10px var(--neon-blue);
            border-color: var(--neon-blue);
        }
        .btn-icon {
            margin-right: 8px;
            fill: white;
            stroke: white;
        }
        .btn::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            width: 100px;
            height: 100px;
            margin-top: -50px;
            margin-left: -50px;
            opacity: 0;
            transition: all 0.7s ease-out;
            transform: scale(0);
        }
        .btn:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease-out;
            pointer-events: none;
        }
        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: var(--dark-overlay);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 0 20px var(--neon-blue), 0 0 0 1px rgba(0, 255, 255, 0.2) inset;
            border: 1px solid var(--neon-blue);
            max-width: 550px;
            width: 90%;
            text-align: center;
            transform: translateY(-50px) scale(0.9);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }
        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: var(--neon-blue);
            transition: all 0.2s;
            line-height: 1;
            padding: 5px;
        }
        .modal-close-btn:hover {
            color: var(--neon-purple);
            transform: rotate(90deg) scale(1.1);
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        input[type=text], input[type=date], select, textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #333;
            border-radius: 12px;
            font-size: 1rem;
            color: var(--text-color);
            transition: border-color .3s ease, box-shadow .3s ease, transform .2s ease-in-out;
            box-sizing: border-box;
            background-color: #1a1a1a;
        }
        input[type=text]:focus, input[type=date]:focus, select:focus, textarea:focus {
            outline: 0;
            border-color: var(--neon-blue);
            box-shadow: 0 0 0 5px rgba(0, 255, 255, 0.3);
            transform: scale(1.01);
        }
        select {
            color: white;
            background-color: #1a1a1a;
        }
        select option {
            background-color: #1a1a1a;
            color: white;
        }
        .radio-group label {
            color: var(--text-color);
        }
        .radio-group input[type=radio] {
            accent-color: var(--neon-blue);
        }
        .rules-section {
            max-height: 60vh;
            overflow-y: auto;
            padding-right: 15px;
            margin-bottom: 20px;
            line-height: 1.7;
            color: var(--text-color);
            text-align: left;
        }
        .rules-section h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--neon-blue);
            margin-top: 25px;
            margin-bottom: 15px;
            text-shadow: 0 0 5px var(--neon-blue);
        }
        
        /* PENTING: Mengubah gaya untuk grup checkbox agar label menjadi clickable */
        .agreement-checkbox-group {
            display: flex;
            align-items: center; /* Menyelaraskan item secara vertikal */
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #333;
            cursor: pointer; /* Menambahkan kursor pointer untuk menunjukkan klik */
            user-select: none; /* Mencegah seleksi teks */
        }

        .agreement-checkbox-group input[type=checkbox] {
            margin-top: 0; /* Menghapus margin atas yang tidak perlu */
            margin-right: 12px;
            width: 20px;
            height: 20px;
            accent-color: var(--neon-blue);
            flex-shrink: 0; /* Mencegah checkbox mengecil */
        }

        .agreement-checkbox-group label {
            font-weight: 500;
            color: var(--text-color);
            text-align: left;
            margin-bottom: 0; /* Menghapus margin bawah pada label */
        }

        #webcamVideo {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            background-color: #000;
            margin: 20px auto;
            display: block;
            border: 4px solid var(--neon-blue);
            transition: border-color .5s ease-in-out;
        }
        #scratchCardWrapper {
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.15);
        }
        #scratchCanvas {
            cursor: grab;
        }
        #scratchCanvas:active {
            cursor: grabbing;
        }
        #hiddenContent {
            background-color: var(--dark-overlay);
            color: var(--text-color);
        }
        #secretPassword {
            background-color: #1a1a1a;
            color: var(--text-color);
        }
        .loading-spinner {
            border: 4px solid rgba(255, 255, 255, .4);
            border-left-color: var(--neon-blue);
            border-radius: 50%;
            width: 28px;
            height: 28px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 10px;
        }
        .qr-code-container canvas {
            background-color: transparent !important;
        }
        #passwordError {
            color: var(--error-color);
        }
        
        /* Broadcast Text Styles */
        .broadcast-container {
            overflow: hidden;
            background-color: rgba(0, 255, 255, 0.1);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
            box-shadow: inset 0 0 5px var(--neon-blue);
        }
        .broadcast-text {
            color: var(--neon-blue);
            font-weight: 600;
            white-space: nowrap;
            display: inline-block;
            animation: marquee 20s linear infinite;
            text-shadow: 0 0 5px var(--neon-blue);
        }

        /* Responsive adjustments for mobile */
        @media (max-width: 640px) {
            .container {
                padding: 20px;
            }
            .modal-content {
                padding: 20px;
            }
            .grid-cols-2 {
                grid-template-columns: 1fr;
            }
        }

        /* CSS Counters for Ordered List */
        .rules-section ol {
            list-style: none; /* Hapus penomoran default browser */
            counter-reset: rule-counter; /* Inisialisasi counter */
        }

        .rules-section ol li {
            counter-increment: rule-counter; /* Tingkatkan counter untuk setiap item daftar */
            position: relative;
            padding-left: 2.5rem; /* Beri ruang untuk nomor kustom */
            margin-bottom: 0.5rem; /* Tambahkan spasi antar item daftar */
        }

        .rules-section ol li::before {
            content: counter(rule-counter) "."; /* Tampilkan nilai counter */
            position: absolute;
            left: 0;
            top: 0;
            font-weight: bold;
            color: var(--neon-blue); /* Atur warna nomor */
            width: 2rem; /* Pastikan ruang yang cukup untuk nomor dua digit */
            text-align: right;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>

    <!-- Main Menu -->
    <div id="mainMenu" class="main-menu-wrapper" aria-hidden="false">
        <div class="container text-center space-y-6 animate-initial-load">
            <div>
                <h1 class="text-4xl md:text-5xl font-extrabold tracking-wider mb-2 glitch-text">XCECUTIVEFIVEID</h1>
                <p class="text-gray-300 text-sm">Since 2017</p>
            </div>
            
            <!-- Broadcast Text -->
            <div class="broadcast-container">
                <p class="broadcast-text">ðŸ“¢ Data Member Update 7 Agust 2025 | Selamat Datang Di XFIVE Community Ayodance</p>
            </div>

            <div class="space-y-4">
                <button id="isiBiodataBtn" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M 6 2 C 5.4777778 2 4.9453899 2.1913289 4.5683594 2.5683594 C 4.1913289 2.9453899 4 3.4777778 4 4 L 4 20 C 4 20.522222 4.1913289 21.05461 4.5683594 21.431641 C 4.9453899 21.808671 5.4777778 22 6 22 L 18 22 C 18.522222 22 19.05461 21.808671 19.431641 21.431641 C 19.808671 21.05461 20 20.522222 20 20 L 20 7.9863281 L 14.013672 2 L 6 2 z M 6 4 L 13 4 L 13 9 L 18 9 L 18 20 L 6 20 L 6 4 z M 8 12 L 8 14 L 16 14 L 16 12 L 8 12 z M 8 16 L 8 18 L 16 18 L 16 16 L 8 16 z"></path>
                    </svg>
                    ISI BIODATA X5
                </button>
                <button id="changeNickBtn" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                    CHANGE NICKNAME
                </button>
                <button id="websiteBtn" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                    WEBSITE
                </button>
                <a href="https://xfivemember2025.netlify.app/" target="_blank" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                    PHOTO MEMBER
                </a>
            </div>

            <div>
                <p class="font-semibold mb-4 text-gray-300">@follow us sosial media</p>
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <a href="https://www.facebook.com/xcecutivefive.id.127" target="_blank" class="btn">
                        <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
                        Facebook
                    </a>
                    <a href="https://instagram.com/exfive.co" target="_blank" class="btn">
                        <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
                        Instagram
                    </a>
                    <a href="https://whatsapp.com/channel/0029VacIZBaFXUucwTdpvl1S" target="_blank" class="btn col-span-2 md:col-span-1">
                        <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M21 12.5c0 .6-.4 1.1-.9 1.2l-4.2.8c-.4.1-.7.5-.7.9V18c0 .6-.4 1.1-.9 1.2l-4.2.8c-.4.1-.7.5-.7.9V22c0 .6-.4 1.1-.9 1.2L2 23.5c-.6.1-1-.4-1-1V2.5c0-.6.4-1.1.9-1.2l4.2-.8c.4-.1.7-.5.7-.9V0c0-.6.4-1.1.9-1.2l4.2-.8c.4-.1.7-.5.7-.9V-4c0-.6.4-1.1.9-1.2l4.2-.8c.6-.1 1 .4 1 1V12.5z"/></svg>
                        Channel Whatsapp
                    </a>
                </div>
            </div>

            <footer class="pt-6 border-t border-gray-800 text-sm text-gray-500">
                <p>2017-2025 XFIVECommunity. All rights reserved.</p>
            </footer>
        </div>
    </div>

    <!-- Registration Form Wrapper (Initially Hidden) -->
    <div id="formWrapper" class="main-content-wrapper hidden" aria-hidden="true">
        <div class="container fade-in">
            <!-- All previous form steps will be injected here by JS -->
        </div>
    </div>

    <!-- All Modals -->
    <!-- Registration Success Modal -->
    <div id="notificationModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
            <button id="modalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
            <h3 id="modalTitle" class="text-2xl font-bold mb-4"></h3>
            <p id="modalMessage" class="mb-6"></p>
            <div id="modalQrCodeContainer" class="qr-code-container"></div>
            <div class="mt-5 flex flex-col sm:flex-row gap-4 justify-center">
                <a id="downloadQrButton" class="btn hidden" style="width:auto; padding: 10px 20px;" download="qr-code-x5.png">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Download QR
                </a>
                <button id="modalResetFormButton" class="btn">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>
                    Isi Formulir Lagi
                </button>
            </div>
        </div>
    </div>

    <!-- Change Nickname Modal -->
    <div id="changeNickModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
            <button id="changeNickModalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
            <h3 class="text-2xl font-bold mb-4">Ganti Nickname</h3>
            <p class="mb-6">Pilih tester yang akan Anda hubungi untuk proses ganti nickname.</p>
            <div class="form-group">
                <select id="testerSelectChangeNick" class="w-full p-3 border rounded-lg text-white bg-[#1a1a1a]">
                    <option value="">-- Pilih Tester --</option>
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <!-- UPDATED QR SECTION FOR CHANGE NICKNAME -->
            <div id="changeNickQrSection" class="hidden mt-6">
                <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
                    <div id="changeNickQrContainer" class="qr-code-container mt-0"></div>
                    <div class="text-center w-full sm:w-auto">
                        <p class="font-semibold text-lg mb-4">Scan Sekarang</p>
                        <a id="downloadChangeNickQrBtn" class="btn inline-block" style="width:auto; padding: 12px 24px;" download>
                            <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            Download QR
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Website "Coming Soon" Modal -->
    <div id="comingSoonModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
                <button id="comingSoonModalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
                <h3 class="text-2xl font-bold mb-4">Segera Hadir!</h3>
                <p>Fitur ini sedang dalam pengembangan. Nantikan update menarik lainnya!</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- All Element Selectors ---
            const mainMenu = document.getElementById('mainMenu');
            const formWrapper = document.getElementById('formWrapper');
            const formContainer = formWrapper.querySelector('.container');
            
            // Main Menu Buttons
            const isiBiodataBtn = document.getElementById('isiBiodataBtn');
            const changeNickBtn = document.getElementById('changeNickBtn');
            const websiteBtn = document.getElementById('websiteBtn');

            // Modals
            const notificationModalOverlay = document.getElementById('notificationModalOverlay');
            const changeNickModalOverlay = document.getElementById('changeNickModalOverlay');
            const comingSoonModalOverlay = document.getElementById('comingSoonModalOverlay');
            
            // --- Data ---
            const testerData = {
                "Ramsky": "6285693393707", "Fadel": "6282173876492",
                "Fajar": "6287750639436", "Thomas": "6281374402822",
                "Joko": "6289514915776", "Citra": "6283825756494",
                "Mey": "6287704534610", "Vandhu": "6281371412119",
                "Ardiansyah": "6287745673345", 
                "Wale": "6282276260740", "Zarah": "6281342620907"
            };
            const googleAppsScriptURL = 'https://script.google.com/macros/s/AKfycbwEUL4YkEYBfaIl1-T2jYueJorhn5SyS2q1YLpse5bhlleULPXIy3TjnwkputvVm156gg/exec';
            
            // --- Define color constants to avoid syntax errors ---
            const NEON_BLUE = '#00FFFF';
            const NEON_PURPLE = '#8A2BE2';
            const ERROR_COLOR = '#FF69B4';

            // --- HTML Templates for Dynamic Content ---
            const formStepsHTML = `
                <button id="backToMenuBtn" class="mb-4 text-white font-semibold hover:underline flex items-center transition-colors">
                    <svg class="mr-2" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                    Kembali ke Menu
                </button>
                <!-- Rules Section -->
                <div id="rulesContainer">
                    <h2 class="text-3xl font-bold text-center mb-8 glitch-text">Peraturan Komunitas X5</h2>
                    <div class="rules-section">
                        <p>Tujuan dibuat aturan yang sangat ketat untuk kepentingan bersama. Kami berkomitmen ingin menciptakan komunitas ini nyaman dan aman untuk siapa saja. Pastikan baca peraturan ini sebelum memulai diskusi.</p>
                        <h3>PERATURAN UMUM UNTUK SEMUA ANGGOTA</h3>
                        <ol>
                            <li>Menjunjung tinggi etika, adab, dan sopan santun kepada semua anggota.</li>
                            <li>Dilarang berdiskusi mendiskriminasi agama dan ras tertentu. Hindari juga berdiskusi SARA, dan politik. [SP/BANNED]</li>
                            <li>Hindari melepas title "X5" tanpa persetujuan moderator/staff. [SP/BANNED]</li>
                            <li>Hindari sebisa mungkin mengirim gambar / video / audio berbau pornografi, obat-obatan, dan kekerasan (jika terpaksa, silakan blur bagian tersebut). [SP/BANNED]</li>
                            <li>Hindari memancing kerusuhan, kericuhan, keonaran yang mengatasnamakan XFIVE. [SP/BANNED]</li>
                            <li>Jika ada masalah sesama anggota harap konfirmasi moderator/admin agar lebih jelas perkaranya. Jangan main keluar sendiri karena petinggi juga akan mengambil jalan keluarnya. [SP]</li>
                            <li>Dilarang membawa masalah personal ke dalam grup XFIVE. Apabila melakukannya akan diberi peringatan dan jika terulang kembali akan dikeluarkan. [SP/BANNED]</li>
                            <li>Berpacaran sesama anggota boleh saja, asal jika ada masalah dengan hubungan kalian. Tolong jangan dicampur adukkan ke komunitas karena efeknya besar sekali terhadap anggota lain. [SP]</li>
                            <li>Diwajibkan menyapa sesama anggota XFIVE (X5!)</li>
                            <li>Dilarang menggunakan program ilegal (cheat) disaat club battle / merugikan orang lain. [SP/BANNED]</li>
                            <li>Khusus member yang sudah bergabung divisi club, Dilarang mengganti ke com. [SP]</li>
                            <li>Dilarang chatting antar member yang belum dikenal dan membuat risih kepada sesama member grup. [SP/BANNED]</li>
                            <li>Menaati pada peraturan komunitas Ayodance (<a href="http://ayodance.megaxus.com/v1/page/rules" target="_blank" class="text-blue-400 hover:underline">http://ayodance.megaxus.com/v1/page/rules</a>)</li>
                        </ol>
                        <h3>KEBIJAKAN PRIVASI</h3>
                        <p>Kebijakan Privasi ini adalah komitmen dari XFIVE untuk menghargai dan melindungi setiap data atau informasi pribadi. Kebijakan Privasi ini menetapkan dasar atas perolehan, pengumpulan, pengolahan, dan atau segala bentuk pengelolaan yang terkait.</p>
                    </div>
                    <!-- Optimized checkbox for better click area -->
                    <div class="mt-8 flex justify-center">
                        <label for="agreeToRules" class="agreement-checkbox-group">
                            <input type="checkbox" id="agreeToRules">
                            <span>Saya menyetujui semua syarat, ketentuan, dan kebijakan privasi yang berlaku.</span>
                        </label>
                    </div>
                    
                    <button type="button" id="continueButton" class="btn text-lg mt-8" disabled>Lanjutkan</button>
                </div>
                <!-- Face Detection Section -->
                <div id="faceDetectionContainer" class="hidden" aria-hidden="true">
                    <h2 class="text-3xl font-bold text-center mb-8 glitch-text">Pendeteksi Wajah</h2>
                    <p class="text-center mb-4">Untuk verifikasi, kami perlu akses kamera Anda. Tidak ada data wajah yang disimpan.</p>
                    <video id="webcamVideo" autoplay muted playsinline></video>
                    <p id="faceDetectionMessage" class="text-center" role="status" aria-live="polite">Menunggu akses kamera...</p>
                    <button type="button" id="startWebcamButton" class="btn text-lg">Mulai Deteksi</button>
                    <button type="button" id="continueToFormButton" class="btn text-lg" disabled>Lanjutkan</button>
                </div>
                <!-- Scratch Card Section -->
                <div id="scratchCardContainer" class="hidden" aria-hidden="true">
                    <h2 class="text-3xl font-bold text-center mb-2 glitch-text">Verifikasi Final!</h2>
                    <p class="mb-6 text-center">Password Singkatan dari XcecutiveFiveID</p>
                    <div id="scratchCardWrapper">
                        <canvas id="scratchCanvas"></canvas>
                        <div id="hiddenContent">
                            <label for="secretPassword" class="font-semibold mb-2">Kata Sandi:</label>
                            <input type="text" id="secretPassword" placeholder="...">
                            <button type="button" id="verifyPasswordButton" class="btn">Verifikasi</button>
                            <p id="passwordError" class="text-red-500 text-sm mt-1 hidden" role="status" aria-live="polite">Salah!</p>
                        </div>
                    </div>
                </div>
                <!-- Member Registration Form -->
                <div id="memberFormContainer" class="hidden" aria-hidden="true">
                    <h1 class="text-3xl font-bold text-center mb-8 glitch-text">Formulir Pendataan Member</h1>
                    <form id="memberForm">
                        <div class="form-group"><label for="namaPanggilan">Nama Panggilan:</label><input type="text" id="namaPanggilan" name="namaPanggilan" required></div>
                        <div class="form-group"><label for="nicknameAyodance">Nickname Ayodance:</label><input type="text" id="nicknameAyodance" name="nicknameAyodance" required></div>
                        <div class="form-group"><label for="tanggalLahir">Tanggal Lahir:</label><input type="date" id="tanggalLahir" name="tanggalLahir" required></div>
                        <div class="form-group"><label for="domisili">Domisili:</label><input type="text" id="domisili" name="domisili" required></div>
                        <div class="form-group">
                            <label>Punya Sosial Media?</label>
                            <div class="radio-group">
                                <label><input type="radio" name="hasSocialMedia" value="Ya"> Ya</label>
                                <label><input type="radio" name="hasSocialMedia" value="Tidak" checked> Tidak</label>
                            </div>
                            <div id="socialMediaInputContainer" class="mt-3 hidden">
                                <label for="sosialMediaName">Nama Sosial Media:</label>
                                <input type="text" id="sosialMediaName" name="sosialMediaName">
                            </div>
                        </div>
                        <div class="form-group"><label for="divisiCommunity">Divisi:</label><select id="divisiCommunity" name="divisiCommunity" required><option value="">Pilih</option><option value="Club">Club</option><option value="Com">Com</option></select></div>
                        <div class="form-group"><label for="tester">Pilih Tester:</label><select id="tester" name="tester" required><option value="">Pilih</option></select></div>
                        <!-- Optimized margin for submit button -->
                        <div class="mt-8">
                            <button type="submit" id="submitButton" class="btn">
                                <span id="buttonText">Kirim Data</span>
                                <span id="loadingSpinner" class="loading-spinner hidden"></span>
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            // --- Functions ---
            function setAriaHidden(element, hidden) {
                if (element) {
                    element.setAttribute('aria-hidden', hidden ? 'true' : 'false');
                }
            }

            function showMainMenu() {
                formWrapper.classList.add('hidden');
                setAriaHidden(formWrapper, true);
                mainMenu.classList.remove('hidden');
                setAriaHidden(mainMenu, false);
            }

            function showForm() {
                mainMenu.classList.add('hidden');
                setAriaHidden(mainMenu, true);
                formWrapper.classList.remove('hidden');
                setAriaHidden(formWrapper, false);
                formContainer.innerHTML = formStepsHTML;
                formContainer.classList.add('fade-in');
                initializeFormLogic();
            }

            function initializeFormLogic() {
                const backToMenuBtn = document.getElementById('backToMenuBtn');
                const rulesContainer = document.getElementById('rulesContainer');
                const faceDetectionContainer = document.getElementById('faceDetectionContainer');
                const scratchCardContainer = document.getElementById('scratchCardContainer');
                const memberFormContainer = document.getElementById('memberFormContainer');
                const agreeToRulesCheckbox = document.getElementById('agreeToRules');
                const continueButton = document.getElementById('continueButton');
                const webcamVideo = document.getElementById('webcamVideo');
                const faceDetectionMessage = document.getElementById('faceDetectionMessage');
                const startWebcamButton = document.getElementById('startWebcamButton');
                const continueToFormButton = document.getElementById('continueToFormButton');
                const scratchCanvas = document.getElementById('scratchCanvas');
                const scratchCardWrapper = document.getElementById('scratchCardWrapper');
                const verifyPasswordButton = document.getElementById('verifyPasswordButton');
                const passwordInput = document.getElementById('secretPassword');
                const passwordError = document.getElementById('passwordError');
                const memberForm = document.getElementById('memberForm');
                const submitButton = document.getElementById('submitButton');
                const buttonText = document.getElementById('buttonText');
                const loadingSpinner = document.getElementById('loadingSpinner');
                const socialMediaYes = document.querySelector('input[name="hasSocialMedia"][value="Ya"]');
                const socialMediaNo = document.querySelector('input[name="hasSocialMedia"][value="Tidak"]');
                const socialMediaInputContainer = document.getElementById('socialMediaInputContainer');
                const testerSelect = document.getElementById('tester');
                const divisiCommunitySelect = document.getElementById('divisiCommunity');

                const notificationModal = {
                    overlay: notificationModalOverlay,
                    title: document.getElementById('modalTitle'),
                    message: document.getElementById('modalMessage'),
                    qrContainer: document.getElementById('modalQrCodeContainer'),
                    downloadBtn: document.getElementById('downloadQrButton'),
                    resetBtn: document.getElementById('modalResetFormButton')
                };

                Object.keys(testerData).forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    testerSelect.appendChild(option);
                });

                function setSelectOptionColors(selectElement) {
                    if (selectElement) {
                        selectElement.style.color = 'white';
                        selectElement.style.backgroundColor = '#1a1a1a';
                        selectElement.addEventListener('focus', () => {
                            Array.from(selectElement.options).forEach(option => {
                                option.style.color = 'white';
                                option.style.backgroundColor = '#1a1a1a';
                            });
                        });
                        selectElement.addEventListener('blur', () => {
                            Array.from(selectElement.options).forEach(option => {
                                option.style.color = 'white';
                                option.style.backgroundColor = '#1a1a1a';
                            });
                        });
                    }
                }
                setSelectOptionColors(testerSelect);
                setSelectOptionColors(divisiCommunitySelect);

                backToMenuBtn.addEventListener('click', showMainMenu);
                agreeToRulesCheckbox.addEventListener('change', () => {
                    continueButton.disabled = !agreeToRulesCheckbox.checked;
                });
                continueButton.addEventListener('click', () => {
                    rulesContainer.classList.add('hidden');
                    setAriaHidden(rulesContainer, true);
                    faceDetectionContainer.classList.remove('hidden');
                    setAriaHidden(faceDetectionContainer, false);
                    faceDetectionContainer.classList.add('fade-in');
                });
                startWebcamButton.addEventListener('click', async () => {
                    startWebcamButton.disabled = true;
                    faceDetectionMessage.textContent = 'Memulai kamera...';
                    try {
                        const mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
                        webcamVideo.srcObject = mediaStream;
                        await webcamVideo.play();
                        faceDetectionMessage.textContent = 'Kamera aktif. Mencari wajah...';
                        webcamVideo.style.borderColor = NEON_BLUE;
                        setTimeout(() => {
                            faceDetectionMessage.textContent = 'Wajah Terdeteksi!';
                            webcamVideo.style.borderColor = NEON_PURPLE;
                            continueToFormButton.disabled = false;
                        }, 3000);
                    } catch (err) {
                        console.error('Error accessing camera:', err);
                        faceDetectionMessage.textContent = 'Gagal mengakses kamera.';
                        webcamVideo.style.borderColor = ERROR_COLOR;
                        startWebcamButton.disabled = false;
                    }
                });
                continueToFormButton.addEventListener('click', () => {
                    if (webcamVideo.srcObject) webcamVideo.srcObject.getTracks().forEach(track => track.stop());
                    faceDetectionContainer.classList.add('hidden');
                    setAriaHidden(faceDetectionContainer, true);
                    scratchCardContainer.classList.remove('hidden');
                    setAriaHidden(scratchCardContainer, false);
                    scratchCardContainer.classList.add('fade-in');
                });
                
                if (scratchCanvas) {
                    const ctx = scratchCanvas.getContext('2d');
                    let isScratching = false;
                    const setupCanvas = () => {
                        scratchCanvas.width = scratchCardWrapper.clientWidth;
                        scratchCanvas.height = scratchCardWrapper.clientHeight;
                        const gradient = ctx.createLinearGradient(0, 0, scratchCanvas.width, scratchCanvas.height);
                        gradient.addColorStop(0, NEON_BLUE);
                        gradient.addColorStop(1, NEON_PURPLE);
                        ctx.fillStyle = gradient;
                        ctx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);
                        ctx.fillStyle = 'rgba(255,255,255,0.8)';
                        ctx.font = 'bold 24px "Inter"';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.fillText('GOSOK DI SINI', scratchCanvas.width / 2, scratchCanvas.height / 2);
                        ctx.globalCompositeOperation = 'destination-out';
                    };
                    const getPos = (e) => ({
                        x: (e.clientX || e.touches[0].clientX) - scratchCanvas.getBoundingClientRect().left,
                        y: (e.clientY || e.touches[0].clientY) - scratchCanvas.getBoundingClientRect().top
                    });
                    const scratch = (e) => {
                        if (!isScratching) return;
                        e.preventDefault();
                        const pos = getPos(e);
                        ctx.beginPath();
                        ctx.arc(pos.x, pos.y, 30, 0, Math.PI * 2, false);
                        ctx.fill();
                    };
                    const reveal = () => {
                        scratchCanvas.style.pointerEvents = 'none';
                        scratchCanvas.style.transition = 'opacity 0.5s';
                        scratchCanvas.style.opacity = '0';
                    };
                    const start = (e) => {
                        isScratching = true;
                        scratch(e);
                    };
                    const end = () => {
                        if (!isScratching) return;
                        isScratching = false;
                        reveal();
                    };
                    window.addEventListener('resize', setupCanvas);
                    scratchCanvas.addEventListener('mousedown', start);
                    scratchCanvas.addEventListener('mouseup', end);
                    scratchCanvas.addEventListener('mouseleave', end);
                    scratchCanvas.addEventListener('mousemove', scratch);
                    scratchCanvas.addEventListener('touchstart', start, { passive: false });
                    scratchCanvas.addEventListener('touchend', end);
                    scratchCanvas.addEventListener('touchmove', scratch, { passive: false });
                    setupCanvas();
                }

                verifyPasswordButton.addEventListener('click', () => {
                    if (passwordInput.value.trim().toUpperCase() === 'X5') {
                        passwordError.classList.add('hidden');
                        scratchCardContainer.classList.add('hidden');
                        setAriaHidden(scratchCardContainer, true);
                        memberFormContainer.classList.remove('hidden');
                        setAriaHidden(memberFormContainer, false);
                        memberFormContainer.classList.add('fade-in');
                    } else {
                        passwordError.classList.remove('hidden');
                    }
                });

                socialMediaYes.addEventListener('change', () => {
                    socialMediaInputContainer.classList.remove('hidden');
                    socialMediaInputContainer.querySelector('input').required = true;
                });
                socialMediaNo.addEventListener('change', () => {
                    socialMediaInputContainer.classList.add('hidden');
                    socialMediaInputContainer.querySelector('input').required = false;
                });

                memberForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    submitButton.disabled = true;
                    buttonText.textContent = 'Mengirim...';
                    loadingSpinner.classList.remove('hidden');
                    const formData = new FormData(memberForm);
                    const data = Object.fromEntries(formData.entries());
                    data.type = 'registration';
                    if (data.hasSocialMedia === 'Tidak') data.sosialMediaName = 'Tidak ada';
                    
                    try {
                        await fetch(googleAppsScriptURL, {
                            method: 'POST',
                            mode: 'no-cors',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(data)
                        });
                        const testerName = data.tester;
                        const qrValue = `https://wa.me/${testerData[testerName]}`;
                        const successMessage = `Terima kasih, <strong>${data.namaPanggilan}</strong>! Data Anda berhasil dikirim. Silakan scan QR ini untuk menghubungi tester kalian.`;
                        
                        notificationModal.title.textContent = 'Pendaftaran Berhasil!';
                        notificationModal.message.innerHTML = successMessage;
                        notificationModal.qrContainer.innerHTML = '';
                        const qrCanvas = document.createElement('canvas');
                        notificationModal.qrContainer.appendChild(qrCanvas);
                        new QRious({ element: qrCanvas, value: qrValue, size: 200 });
                        notificationModal.downloadBtn.href = qrCanvas.toDataURL('image/png');
                        notificationModal.downloadBtn.download = `qr-code-x5-${data.namaPanggilan}.png`;
                        notificationModal.downloadBtn.classList.remove('hidden');
                        notificationModal.overlay.classList.add('show');
                        setAriaHidden(notificationModal.overlay, false);
                        memberFormContainer.classList.add('hidden');
                        setAriaHidden(memberFormContainer, true);
                    } catch (error) {
                        console.error('Error submitting form:', error);
                        notificationModal.title.textContent = 'Terjadi Kesalahan';
                        notificationModal.message.innerHTML = 'Maaf, data Anda gagal dikirim. Silakan coba lagi nanti.';
                        notificationModal.overlay.classList.add('show');
                        setAriaHidden(notificationModal.overlay, false);
                    } finally {
                        submitButton.disabled = false;
                        buttonText.textContent = 'Kirim Data';
                        loadingSpinner.classList.add('hidden');
                    }
                });

                notificationModal.resetBtn.addEventListener('click', () => {
                    notificationModal.overlay.classList.remove('show');
                    setAriaHidden(notificationModal.overlay, true);
                    showMainMenu();
                });
            }

            // --- Main Menu Event Listeners ---
            isiBiodataBtn.addEventListener('click', showForm);
            
            const showComingSoonModal = () => {
                comingSoonModalOverlay.classList.add('show');
                setAriaHidden(comingSoonModalOverlay, false);
            };

            websiteBtn.addEventListener('click', showComingSoonModal);
            
            const testerSelectChangeNick = document.getElementById('testerSelectChangeNick');
            const changeNickQrSection = document.getElementById('changeNickQrSection');
            const changeNickQrContainer = document.getElementById('changeNickQrContainer');
            const downloadChangeNickQrBtn = document.getElementById('downloadChangeNickQrBtn');

            Object.keys(testerData).forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                testerSelectChangeNick.appendChild(option);
            });
            
            changeNickBtn.addEventListener('click', () => {
                testerSelectChangeNick.value = '';
                changeNickQrSection.classList.add('hidden');
                changeNickModalOverlay.classList.add('show');
                setAriaHidden(changeNickModalOverlay, false);
            });

            testerSelectChangeNick.addEventListener('change', function() {
                const testerName = this.value;
                if (!testerName) {
                    changeNickQrSection.classList.add('hidden');
                    return;
                }
                const phone = testerData[testerName];
                const message = encodeURIComponent("halo saya ingin meganti nickname.\n\nNick Awal :\nNick Ganti :\n\nTerimakasih");
                const qrValue = `https://wa.me/${phone}?text=${message}`;
                
                changeNickQrContainer.innerHTML = '';
                const qrCanvas = document.createElement('canvas');
                changeNickQrContainer.appendChild(qrCanvas);
                new QRious({ element: qrCanvas, value: qrValue, size: 160 });

                downloadChangeNickQrBtn.href = qrCanvas.toDataURL('image/png');
                downloadChangeNickQrBtn.download = `qr-ganti-nick-${testerName}.png`;
                
                changeNickQrSection.classList.remove('hidden');
            });

            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('show');
                        setAriaHidden(this, true);
                    }
                });
                const closeBtn = overlay.querySelector('.modal-close-btn');
                if (closeBtn) {
                    closeBtn.addEventListener('click', () => {
                        overlay.classList.remove('show');
                        setAriaHidden(overlay, true);
                    });
                }
            });

            document.querySelectorAll('.btn').forEach(button => {
                button.addEventListener('click', function(e) {
                    if (this.disabled) return;
                    const x = e.clientX - this.getBoundingClientRect().left;
                    const y = e.clientY - this.getBoundingClientRect().top;
                    const ripple = document.createElement('span');
                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';
                    ripple.classList.add('ripple');
                    this.appendChild(ripple);
                    ripple.addEventListener('animationend', function() {
                        this.remove();
                    });
                });
            });
        });
    </script>
</body>
</html>
