<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XCECUTIVEFIVEID Community Hub</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom CSS */
        @keyframes backgroundPan {
            0% { background-position: 0% 0%, 100% 100%, 0% 0%; }
            50% { background-position: 20% 10%, 80% 90%, 10% 20%; }
            100% { background-position: 0% 0%, 100% 100%, 0% 0%; }
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #000; /* Dark background */
            /* Enhanced background with more dynamic gradients */
            background-image: radial-gradient(at 80% 0%, hsla(218,100%,70%,0.1) 0px, transparent 50%),
                              radial-gradient(at 0% 100%, hsla(280,100%,80%,0.1) 0px, transparent 50%),
                              linear-gradient(to bottom right, #111, #222); /* Darker gradients */
            background-repeat: no-repeat;
            background-attachment: fixed;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
            transition: background-color 0.5s ease; /* Smooth transition for background changes */
            animation: backgroundPan 60s linear infinite alternate; /* Long, subtle animation for background */
        }
        .main-content-wrapper, .main-menu-wrapper {
            width: 100%;
            max-width: 700px;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: rgba(0, 0, 0, 0.7); /* Dark transparent background */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 30px;
            border-radius: 20px;
            /* Adjusted neon-themed shadow and border for container */
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.1), 0 0 0 1px rgba(0, 255, 255, 0.08) inset;
            border: 1px solid rgba(0, 255, 255, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* Smooth transition for container */
        }
        .container:hover {
            transform: translateY(-5px); /* Subtle lift on hover */
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.2), 0 0 0 1px rgba(0, 255, 255, 0.15) inset;
        }
        /* Initial load animation for main menu */
        .animate-initial-load {
            opacity: 0;
            transform: translateY(30px) scale(0.95);
            animation: fadeInPopUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        @keyframes fadeInPopUp {
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        /* Fade in for form/modal content */
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .hidden { display: none; }

        /* Refined Neon effect for all buttons */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 14px;
            border: 1px solid rgba(0, 255, 255, 0.3); /* Initial subtle neon border */
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white; /* Text color */
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
            z-index: 1;
            background-color: rgba(0, 0, 0, 0.6); /* Slightly dark transparent fill */
            /* Initial neon glow box-shadow */
            box-shadow: 0 0 5px rgba(0, 255, 255, 0.3), inset 0 0 5px rgba(0, 255, 255, 0.2);
        }

        .btn:hover {
            transform: translateY(-4px) scale(1.02); /* More pronounced lift and slight scale */
            /* Stronger neon glow on hover */
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.6), inset 0 0 10px rgba(0, 255, 255, 0.4);
            border-color: rgba(0, 255, 255, 0.6); /* More intense border on hover */
        }

        /* Ensure text and icon are above the pseudo-element for the ripple effect */
        .btn span, .btn svg {
            position: relative;
            z-index: 2; /* Higher z-index than ::after */
            fill: white; /* Ensure SVG fill is white */
            stroke: white; /* Ensure SVG stroke is white */
        }

        .btn-icon {
            margin-right: 8px; /* Space between icon and text */
        }

        /* Ripple effect for buttons */
        .btn::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            width: 100px;
            height: 100px;
            margin-top: -50px;
            margin-left: -50px;
            opacity: 0;
            transition: all 0.7s ease-out;
            transform: scale(0);
        }
        .btn:active::after {
            transform: scale(2);
            opacity: 1;
            transition: 0s;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.4s ease-out;
            pointer-events: none;
        }
        .modal-overlay.show {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: rgba(0, 0, 0, 0.85); /* Darker transparent modal */
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            /* Adjusted neon-themed shadow and border for modal */
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4), 0 0 0 1px rgba(0, 255, 255, 0.2) inset;
            border: 1px solid rgba(0, 255, 255, 0.3);
            max-width: 550px;
            width: 90%;
            text-align: center;
            transform: translateY(-50px) scale(0.9); /* Initial state for modal animation */
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }
        .modal-overlay.show .modal-content {
            transform: translateY(0) scale(1); /* Final state for modal animation */
            opacity: 1;
        }
        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            color: #00FFFF; /* Neon cyan close button */
            transition: all 0.2s;
            line-height: 1; /* Ensure proper alignment for 'x' */
            padding: 5px; /* Increase clickable area */
        }
        .modal-close-btn:hover {
            color: #8A2BE2; /* Different neon color on hover */
            transform: rotate(90deg) scale(1.1); /* More dynamic hover */
        }

        /* Form elements styling */
        .form-group{margin-bottom:20px}
        label{display:block;margin-bottom:8px;font-weight:600;color:#e0e0e0} /* Light label color */
        h1, h2, h3 {
            color: #00FFFF; /* Neon cyan for headings */
            text-shadow: 0 0 5px #00FFFF, 0 0 10px #8A2BE2; /* Subtle neon text glow */
        }
        p, li {
            color: #e0e0e0; /* Light gray for general text */
        }
        input[type=text],
        input[type=date],
        select,
        textarea{
            width:100%;
            padding:14px;
            border:1px solid #333; /* Darker border */
            border-radius:12px;
            font-size:1rem;
            color:#e0e0e0; /* Light text color */
            transition:border-color .3s ease,box-shadow .3s ease, transform .2s ease-in-out;
            box-sizing:border-box;
            background-color:#1a1a1a; /* Dark input background */
        }
        input[type=text]:focus,
        input[type=date]:focus,
        select:focus,
        textarea:focus{
            outline:0;
            border-color:#00FFFF; /* Neon cyan border on focus */
            box-shadow:0 0 0 5px rgba(0, 255, 255, 0.3); /* Neon cyan glow on focus */
            transform: scale(1.01); /* Subtle grow on focus */
        }
        /* Specific styling for select dropdown options */
        select {
            color: white; /* Default text color for select */
            background-color: #1a1a1a; /* Dark background for the select box */
        }
        /* Styling for the options within the select dropdown */
        select option {
            background-color: #1a1a1a; /* Dark background for options */
            color: white; /* White text for options */
        }
        .radio-group{display:flex;flex-wrap:wrap;gap:20px;margin-top:5px}
        .radio-group label{display:flex;align-items:center;font-weight:400;cursor:pointer; color:#e0e0e0;} /* Light label color */
        .radio-group input[type=radio]{width:auto;margin-right:8px;accent-color:#00FFFF;transform:scale(1.2)} /* Neon accent color */
        .rules-section{
            max-height:60vh;
            overflow-y:auto; /* Added scrollbar for rules section */
            padding-right:15px;
            margin-bottom:20px;
            line-height:1.7;
            color:#e0e0e0;
            text-align:left
        }
        .rules-section h3{font-size:1.5rem;font-weight:600;color:#00FFFF;margin-top:25px;margin-bottom:15px} /* Neon heading */
        .rules-section ol{list-style-position:inside;padding-left:5px}
        .rules-section li{margin-bottom:10px}
        .agreement-checkbox-group{display:flex;align-items:flex-start;margin-top:20px;padding-top:20px;border-top:1px solid #333} /* Darker border */
        .agreement-checkbox-group input[type=checkbox]{margin-top:5px;margin-right:12px;width:20px;height:20px;accent-color:#00FFFF} /* Neon accent color */
        .agreement-checkbox-group label{font-weight:500;cursor:pointer;color:#e0e0e0;text-align:left;flex:1} /* Light label color */
        #faceDetectionContainer{text-align:center}
        #webcamVideo{width:100%;max-width:400px;height:auto;border-radius:12px;box-shadow:0 5px 15px rgba(0, 0, 0, 0.2);background-color:#000;margin:20px auto;display:block;border:4px solid #00FFFF;transition:border-color .5s ease-in-out} /* Neon border */
        #faceDetectionMessage{margin-top:15px;font-size:1.1rem;color:#e0e0e0;font-weight:500} /* Light text color */
        #scratchCardWrapper{position:relative;width:100%;max-width:450px;margin:0 auto;height:200px;border-radius:16px;box-shadow:0 10px 30px rgba(0, 255, 255, 0.15);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none} /* Neon shadow */
        #scratchCanvas{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:16px;cursor:grab;pointer-events:auto}
        #scratchCanvas:active{cursor:grabbing}
        #hiddenContent{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background-color:rgba(0, 0, 0, 0.9);border-radius:16px;padding:20px; color: #e0e0e0;} /* Dark hidden content */
        #secretPassword{text-align:center;font-size:1.2rem;padding:12px; background-color: #1a1a1a; color: #e0e0e0;} /* Dark input */
        #verifyPasswordButton{width:auto;padding:10px 24px;font-size:1rem;margin-top:15px}
        .loading-spinner{border:4px solid rgba(255,255,255,.4);border-left-color:#00FFFF;border-radius:50%;width:28px;height:28px;animation:spin 1s linear infinite;display:inline-block;vertical-align:middle;margin-right:10px} /* Neon spinner */
        .qr-code-container{margin-top:20px;display:inline-block}
        .qr-code-container canvas {
            background-color: transparent !important; /* Ensure QR background is transparent */
        }
        #passwordError {
            color: #FF69B4; /* Hot pink for error, stands out */
        }
    </style>
</head>
<body>

    <!-- Main Menu -->
    <div id="mainMenu" class="main-menu-wrapper" aria-hidden="false">
        <div class="container text-center space-y-6 animate-initial-load">
            <div>
                <!-- Optimized for mobile: text-4xl for default, md:text-3xl for medium, sm:text-2xl for small screens -->
                <h1 class="text-4xl md:text-3xl sm:text-2xl font-extrabold tracking-wider">XCECUTIVEFIVEID</h1>
                <p class="text-gray-300">Since 2017</p>
            </div>
            
            <div class="space-y-4">
                <button id="isiBiodataBtn" class="btn text-lg">
                    <!-- Updated SVG icon for ISI BIODATA X5 with white fill -->
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="24" height="24" viewBox="0 0 24 24" fill="white">
                        <path d="M 6 2 C 5.4777778 2 4.9453899 2.1913289 4.5683594 2.5683594 C 4.1913289 2.9453899 4 3.4777778 4 4 L 4 20 C 4 20.522222 4.1913289 21.05461 4.5683594 21.431641 C 4.9453899 21.808671 5.4777778 22 6 22 L 18 22 C 18.522222 22 19.05461 21.808671 19.431641 21.431641 C 19.808671 21.05461 20 20.522222 20 20 L 20 7.9863281 L 14.013672 2 L 6 2 z M 6 4 L 13 4 L 13 9 L 18 9 L 18 20 L 6 20 L 6 4 z M 8 12 L 8 14 L 16 14 L 16 12 L 8 12 z M 8 16 L 8 18 L 16 18 L 16 16 L 8 16 z"></path>
                    </svg>
                    ISI BIODATA X5
                </button>
                <button id="changeNickBtn" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                    CHANGE NICKNAME
                </button>
                <button id="websiteBtn" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M2 12h20"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                    WEBSITE
                </button>
                <a href="https://xfivemember2025.netlify.app/" target="_blank" class="btn text-lg">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                    PHOTO MEMBER
                </a>
            </div>

            <div>
                <p class="font-semibold mb-4 text-gray-300">@follow us sosial media</p>
                <div class="grid grid-cols-2 gap-4">
                    <a href="https://www.facebook.com/xcecutivefive.id.127" target="_blank" class="btn">
                        <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>
                        Facebook
                    </a>
                    <a href="https://instagram.com/exfive.co" target="_blank" class="btn">
                        <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/></svg>
                        Instagram
                    </a>
                </div>
                <a href="https://whatsapp.com/channel/0029VacIZBaFXUucwTdpvl1S" target="_blank" class="btn mt-4">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M21 12.5c0 .6-.4 1.1-.9 1.2l-4.2.8c-.4.1-.7.5-.7.9V18c0 .6-.4 1.1-.9 1.2l-4.2.8c-.4.1-.7.5-.7.9V22c0 .6-.4 1.1-.9 1.2L2 23.5c-.6.1-1-.4-1-1V2.5c0-.6.4-1.1.9-1.2l4.2-.8c.4-.1.7-.5.7-.9V0c0-.6.4-1.1.9-1.2l4.2-.8c.4-.1.7-.5.7-.9V-4c0-.6.4-1.1.9-1.2l4.2-.8c.6-.1 1 .4 1 1V12.5z"/></svg>
                    Channel Whatsapp
                </a>
            </div>

            <footer class="pt-6 border-t border-gray-800 text-sm text-gray-500">
                <p>2017-2025 XFIVECommunity. All rights reserved.</p>
            </footer>
        </div>
    </div>

    <!-- Registration Form Wrapper (Initially Hidden) -->
    <div id="formWrapper" class="main-content-wrapper hidden" aria-hidden="true">
        <div class="container fade-in">
            <!-- All previous form steps will be injected here by JS -->
        </div>
    </div>

    <!-- All Modals -->
    <!-- Registration Success Modal -->
    <div id="notificationModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
            <button id="modalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
            <h3 id="modalTitle" class="text-2xl font-bold mb-4"></h3>
            <p id="modalMessage" class="mb-6"></p>
            <div id="modalQrCodeContainer" class="qr-code-container"></div>
            <div class="mt-5 flex flex-col sm:flex-row gap-4 justify-center">
                <a id="downloadQrButton" class="btn hidden" style="width:auto; padding: 10px 20px;" download="qr-code-x5.png">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Download QR
                </a>
                <button id="modalResetFormButton" class="btn">
                    <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M3 21v-5h5"/></svg>
                    Isi Formulir Lagi
                </button>
            </div>
        </div>
    </div>

    <!-- Change Nickname Modal -->
    <div id="changeNickModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
            <button id="changeNickModalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
            <h3 class="text-2xl font-bold mb-4">Ganti Nickname</h3>
            <p class="mb-6">Pilih tester yang akan Anda hubungi untuk proses ganti nickname.</p>
            <div class="form-group">
                <select id="testerSelectChangeNick" class="w-full p-3 border rounded-lg">
                    <option value="">-- Pilih Tester --</option>
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <!-- UPDATED QR SECTION FOR CHANGE NICKNAME -->
            <div id="changeNickQrSection" class="hidden mt-6">
                <div class="flex flex-col sm:flex-row items-center justify-center gap-6">
                    <div id="changeNickQrContainer" class="qr-code-container mt-0"></div>
                    <!-- Adjusted text alignment and margin for better spacing -->
                    <div class="text-center w-full sm:w-auto">
                        <p class="font-semibold text-lg mb-4">Scan Sekarang</p>
                        <a id="downloadChangeNickQrBtn" class="btn inline-block" style="width:auto; padding: 12px 24px;" download>
                            <svg class="btn-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                            Download QR
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Website "Coming Soon" Modal -->
    <div id="comingSoonModalOverlay" class="modal-overlay" aria-hidden="true">
        <div class="modal-content">
              <button id="comingSoonModalCloseBtn" class="modal-close-btn" aria-label="Tutup Modal">&times;</button>
              <h3 class="text-2xl font-bold mb-4">Segera Hadir!</h3>
              <p>Fitur ini sedang dalam pengembangan. Nantikan update menarik lainnya!</p>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // --- All Element Selectors ---
        const mainMenu = document.getElementById('mainMenu');
        const formWrapper = document.getElementById('formWrapper');
        const formContainer = formWrapper.querySelector('.container');
        
        // Main Menu Buttons
        const isiBiodataBtn = document.getElementById('isiBiodataBtn');
        const changeNickBtn = document.getElementById('changeNickBtn');
        const websiteBtn = document.getElementById('websiteBtn');

        // Modals
        const notificationModalOverlay = document.getElementById('notificationModalOverlay');
        const changeNickModalOverlay = document.getElementById('changeNickModalOverlay');
        const comingSoonModalOverlay = document.getElementById('comingSoonModalOverlay');
        
        // --- Data (Eza Removed) ---
        const testerData = {
            "Ramsky": "6285693393707", "Fadel": "6282173876492",
            "Fajar": "6287750639436", "Thomas": "6281374402822",
            "Joko": "6289514915776", "Citra": "6283825756494",
            "Mey": "6287704534610", "Vandhu": "6281371412119",
            "Ardiansyah": "6287745673345", 
            "Wale": "6282276260740", "Zarah": "6281342620907"
        };
        const googleAppsScriptURL = 'https://script.google.com/macros/s/AKfycbwEUL4YkEYBfaIl1-T2jYueJorhn5SyS2q1YLpse5bhlleULPXIy3TjnwkputvVm156gg/exec';

        // --- HTML Templates for Dynamic Content ---
        const formStepsHTML = `
            <button id="backToMenuBtn" class="mb-4 text-indigo-400 font-semibold hover:underline flex items-center">
                <svg class="mr-2" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
                Kembali ke Menu
            </button>
            <!-- Rules Section -->
            <div id="rulesContainer">
                <h2 class="text-3xl font-bold text-center mb-8">Peraturan Komunitas X5</h2>
                <div class="rules-section">
                    <p>Tujuan dibuat aturan yang sangat ketat untuk kepentingan bersama. Kami berkomitmen ingin menciptakan komunitas ini nyaman dan aman untuk siapa saja. Pastikan baca peraturan ini sebelum memulai diskusi.</p>
                    <h3>PERATURAN UMUM UNTUK SEMUA ANGGOTA</h3>
                    <ol class="list-decimal">
                        <li>Menjunjung tinggi etika, adab dan sopan santun kepada semua anggota.</li>
                        <li>Dilarang berdiskusi mendiskriminasi agama dan ras tertentu. Hindari juga berdiskusi sara, dan politik. [SP/BANNED]</li>
                        <li>Hindari melepas tittle ''X5'' tanpa persetujuan moderator/staff. [SP/BANNED]</li>
                        <li>Hindari sebisa mungkin mengirim gambar / video / audio berbau ponografi, obat obat an, dan kekerasan (jika terpaksa, silahkan blur bagian tersebut). [SP/BANNED]</li>
                        <li>Hindari memancing kerusuhan, kericuhan, keonaran yang mengatasnamakan XFIVE. [SP/BANNED]</li>
                        <li>Jika ada masalah sesama anggota harap konfirmasi moderator/admin biar lebih jelas perkaranya . jangan main out sendiri karna petinggi juga akan mengambil jalan keluarnya. [SP]</li>
                        <li>Dilarang membawa masalah personal ke dalam grup XFIVE. apabila melakukannya akan di beri peringatan dan jika terulang kembali kick out. [SP/BANNED]</li>
                        <li>Berpacaran sesama anggota boleh saja, asal jika ada masalah dengan hubungan kalian. Tolong jangan di campur adukkan ke community karena efeknya besar sekali terhadap anggota lain. [SP]</li>
                        <li>Diwajibkan menyapa sesama anggota XFIVE ( X5! )</li>
                        <li>Dilarang menggunakan program ilegal (cheat) disaat club battle / merugikan orang lain. [SP/BANNED]</li>
                        <li>Khusus member yang sudah bergabung divisi club, Dilarang meganti ke com. [SP]</li>
                        <li>Dilarang chatting antar member yang belum dikenal dan membuat risih kepada sesama member grup [SP/BANNED]</li>
                        <li>Menaati pada peraturan komunitas Ayodance (<a href="http://ayodance.megaxus.com/v1/page/rules" target="_blank" class="text-blue-400 hover:underline">http://ayodance.megaxus.com/v1/page/rules</a>)</li>
                    </ol>
                    <h3>KEBIJAKAN PRIVASI</h3>
                    <p>Kebijakan Privasi ini adalah komitmen dari XFIVE untuk menghargai dan melindungi setiap data atau informasi pribadi. Kebijakan Privasi ini menetapkan dasar atas perolehan, pengumpulan, pengolahan, dan atau segala bentuk pengelolaan yang terkait.</p>
                </div>
                <div class="agreement-checkbox-group">
                    <input type="checkbox" id="agreeToRules">
                    <label for="agreeToRules">Saya menyetujui semua syarat, ketentuan, dan kebijakan privasi yang berlaku.</label>
                </div>
                <button type="button" id="continueButton" class="btn text-lg" disabled>Lanjutkan</button>
            </div>
            <!-- Face Detection Section -->
            <div id="faceDetectionContainer" class="hidden" aria-hidden="true"><h2 class="text-3xl font-bold text-center mb-8">Pendeteksi Wajah</h2><p class="text-center mb-4">Untuk verifikasi, kami perlu akses kamera Anda. Tidak ada data wajah yang disimpan.</p><video id="webcamVideo" autoplay muted playsinline></video><p id="faceDetectionMessage" class="text-center" role="status" aria-live="polite">Menunggu akses kamera...</p><button type="button" id="startWebcamButton" class="btn text-lg">Mulai Deteksi</button><button type="button" id="continueToFormButton" class="btn text-lg" disabled>Lanjutkan</button></div>
            <!-- Scratch Card Section -->
            <div id="scratchCardContainer" class="hidden" aria-hidden="true"><h2 class="text-3xl font-bold text-center mb-2">Verifikasi Final!</h2><p class="mb-6 text-center">Password Singkatan dari XcecutiveFiveID</p><div id="scratchCardWrapper"><canvas id="scratchCanvas"></canvas><div id="hiddenContent"><label for="secretPassword" class="font-semibold mb-2">Kata Sandi:</label><input type="text" id="secretPassword" placeholder="..."><button type="button" id="verifyPasswordButton" class="btn">Verifikasi</button><p id="passwordError" class="text-red-500 text-sm mt-1 hidden" role="status" aria-live="polite">Salah!</p></div></div></div>
            <!-- Member Registration Form -->
            <div id="memberFormContainer" class="hidden" aria-hidden="true"><h1 class="text-3xl font-bold text-center mb-8">Formulir Pendataan Member</h1><form id="memberForm"><div class="form-group"><label for="namaPanggilan">Nama Panggilan:</label><input type="text" id="namaPanggilan" name="namaPanggilan" required></div><div class="form-group"><label for="nicknameAyodance">Nickname Ayodance:</label><input type="text" id="nicknameAyodance" name="nicknameAyodance" required></div><div class="form-group"><label for="tanggalLahir">Tanggal Lahir:</label><input type="date" id="tanggalLahir" name="tanggalLahir" required></div><div class="form-group"><label for="domisili">Domisili:</label><input type="text" id="domisili" name="domisili" required></div><div class="form-group"><label>Punya Sosial Media?</label><div class="radio-group"><label><input type="radio" name="hasSocialMedia" value="Ya"> Ya</label><label><input type="radio" name="hasSocialMedia" value="Tidak" checked> Tidak</label></div><div id="socialMediaInputContainer" class="mt-3 hidden"><label for="sosialMediaName">Nama Sosial Media:</label><input type="text" id="sosialMediaName" name="sosialMediaName"></div></div><div class="form-group"><label for="divisiCommunity">Divisi:</label><select id="divisiCommunity" name="divisiCommunity" required><option value="">Pilih</option><option value="Club">Club</option><option value="Com">Com</option></select></div><div class="form-group"><label for="tester">Pilih Tester:</label><select id="tester" name="tester" required><option value="">Pilih</option></select></div><button type="submit" id="submitButton" class="btn"><span id="buttonText">Kirim Data</span><span id="loadingSpinner" class="loading-spinner hidden"></span></button></form></div>
        `;
        
        // --- Functions ---
        function setAriaHidden(element, hidden) {
            if (element) {
                element.setAttribute('aria-hidden', hidden ? 'true' : 'false');
            }
        }

        function showMainMenu() {
            formWrapper.classList.add('hidden');
            setAriaHidden(formWrapper, true);
            mainMenu.classList.remove('hidden');
            setAriaHidden(mainMenu, false);
        }

        function showForm() {
            mainMenu.classList.add('hidden');
            setAriaHidden(mainMenu, true);
            formWrapper.classList.remove('hidden');
            setAriaHidden(formWrapper, false);
            formContainer.innerHTML = formStepsHTML;
            formContainer.classList.add('fade-in'); // Add fade-in animation
            initializeFormLogic();
        }

        function initializeFormLogic() {
            // Re-select all elements within the newly injected form
            const backToMenuBtn = document.getElementById('backToMenuBtn');
            const rulesContainer = document.getElementById('rulesContainer');
            const faceDetectionContainer = document.getElementById('faceDetectionContainer');
            const scratchCardContainer = document.getElementById('scratchCardContainer');
            const memberFormContainer = document.getElementById('memberFormContainer');
            const agreeToRulesCheckbox = document.getElementById('agreeToRules');
            const continueButton = document.getElementById('continueButton');
            const webcamVideo = document.getElementById('webcamVideo');
            const faceDetectionMessage = document.getElementById('faceDetectionMessage');
            const startWebcamButton = document.getElementById('startWebcamButton');
            const continueToFormButton = document.getElementById('continueToFormButton');
            const scratchCanvas = document.getElementById('scratchCanvas');
            const scratchCardWrapper = document.getElementById('scratchCardWrapper');
            const verifyPasswordButton = document.getElementById('verifyPasswordButton');
            const passwordInput = document.getElementById('secretPassword');
            const passwordError = document.getElementById('passwordError');
            const memberForm = document.getElementById('memberForm');
            const submitButton = document.getElementById('submitButton');
            const buttonText = document.getElementById('buttonText');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const socialMediaYes = document.querySelector('input[name="hasSocialMedia"][value="Ya"]');
            const socialMediaNo = document.querySelector('input[name="hasSocialMedia"][value="Tidak"]');
            const socialMediaInputContainer = document.getElementById('socialMediaInputContainer');
            const testerSelect = document.getElementById('tester');
            const divisiCommunitySelect = document.getElementById('divisiCommunity'); // Select for Divisi

            
            // Modal elements for form
            const notificationModal = {
                overlay: notificationModalOverlay, // Use already selected overlay
                title: document.getElementById('modalTitle'),
                message: document.getElementById('modalMessage'),
                qrContainer: document.getElementById('modalQrCodeContainer'),
                downloadBtn: document.getElementById('downloadQrButton'),
                resetBtn: document.getElementById('modalResetFormButton')
            };

            // Populate tester dropdown
            Object.keys(testerData).forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                testerSelect.appendChild(option);
            });

            // Set option colors for testerSelect and divisiCommunitySelect
            function setSelectOptionColors(selectElement) {
                if (selectElement) {
                    // Set default color for the select element itself when no option is selected
                    selectElement.style.color = 'white';
                    selectElement.style.backgroundColor = '#1a1a1a'; // Dark background

                    // Apply styles to options when the dropdown is open
                    selectElement.addEventListener('focus', () => {
                        Array.from(selectElement.options).forEach(option => {
                            option.style.color = 'white';
                            option.style.backgroundColor = '#1a1a1a';
                        });
                    });
                     // Revert to default when focus is lost
                    selectElement.addEventListener('blur', () => {
                        Array.from(selectElement.options).forEach(option => {
                            option.style.color = 'white';
                            option.style.backgroundColor = '#1a1a1a';
                        });
                    });
                }
            }
            setSelectOptionColors(testerSelect);
            setSelectOptionColors(divisiCommunitySelect);


            // --- Event Listeners for Form Steps ---
            backToMenuBtn.addEventListener('click', showMainMenu);
            agreeToRulesCheckbox.addEventListener('change', () => { continueButton.disabled = !agreeToRulesCheckbox.checked; });
            continueButton.addEventListener('click', () => {
                rulesContainer.classList.add('hidden');
                setAriaHidden(rulesContainer, true);
                faceDetectionContainer.classList.remove('hidden');
                setAriaHidden(faceDetectionContainer, false);
                faceDetectionContainer.classList.add('fade-in'); // Add fade-in animation
            });
            startWebcamButton.addEventListener('click', async () => {
                startWebcamButton.disabled = true; faceDetectionMessage.textContent = 'Memulai kamera...';
                try {
                    const mediaStream = await navigator.mediaDevices.getUserMedia({ video: true });
                    webcamVideo.srcObject = mediaStream; await webcamVideo.play();
                    faceDetectionMessage.textContent = 'Kamera aktif. Mencari wajah...';
                    webcamVideo.style.borderColor = '#00FFFF'; /* Neon cyan border */
                    setTimeout(() => {
                        faceDetectionMessage.textContent = 'Wajah Terdeteksi!';
                        webcamVideo.style.borderColor = '#8A2BE2'; /* Blue-violet neon when detected */
                        continueToFormButton.disabled = false;
                    }, 3000);
                } catch (err) {
                    console.error('Error accessing camera:', err);
                    faceDetectionMessage.textContent = 'Gagal mengakses kamera.';
                    webcamVideo.style.borderColor = '#FF69B4'; /* Hot pink for error */
                    startWebcamButton.disabled = false;
                }
            });
            continueToFormButton.addEventListener('click', () => {
                if (webcamVideo.srcObject) webcamVideo.srcObject.getTracks().forEach(track => track.stop());
                faceDetectionContainer.classList.add('hidden');
                setAriaHidden(faceDetectionContainer, true);
                scratchCardContainer.classList.remove('hidden');
                setAriaHidden(scratchCardContainer, false);
                scratchCardContainer.classList.add('fade-in'); // Add fade-in animation
            });
            
            // Scratch Card Logic
            if (scratchCanvas) {
                const ctx = scratchCanvas.getContext('2d'); let isScratching = false;
                const setupCanvas = () => {
                    scratchCanvas.width = scratchCardWrapper.clientWidth; scratchCanvas.height = scratchCardWrapper.clientHeight;
                    const gradient = ctx.createLinearGradient(0,0,scratchCanvas.width,scratchCanvas.height);
                    gradient.addColorStop(0, '#00FFFF'); /* Neon cyan */
                    gradient.addColorStop(1, '#8A2BE2'); /* Blue-violet neon */
                    ctx.fillStyle = gradient; ctx.fillRect(0,0,scratchCanvas.width,scratchCanvas.height);
                    ctx.fillStyle = 'rgba(255,255,255,0.8)'; ctx.font = 'bold 24px "Inter"';
                    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                    ctx.fillText('GOSOK DI SINI', scratchCanvas.width/2, scratchCanvas.height/2);
                    ctx.globalCompositeOperation = 'destination-out';
                };
                const getPos = (e) => ({ x: (e.clientX||e.touches[0].clientX) - scratchCanvas.getBoundingClientRect().left, y: (e.clientY||e.touches[0].clientY) - scratchCanvas.getBoundingClientRect().top });
                const scratch = (e) => { if(!isScratching) return; e.preventDefault(); const pos = getPos(e); ctx.beginPath(); ctx.arc(pos.x,pos.y,30,0,Math.PI*2,false); ctx.fill(); };
                const reveal = () => { scratchCanvas.style.pointerEvents = 'none'; scratchCanvas.style.transition = 'opacity 0.5s'; scratchCanvas.style.opacity = '0'; };
                const start = (e) => { isScratching = true; scratch(e); };
                const end = () => { if(!isScratching) return; isScratching = false; reveal(); };
                window.addEventListener('resize', setupCanvas);
                scratchCanvas.addEventListener('mousedown', start); scratchCanvas.addEventListener('mouseup', end);
                scratchCanvas.addEventListener('mouseleave', end); scratchCanvas.addEventListener('mousemove', scratch);
                scratchCanvas.addEventListener('touchstart', start, {passive:false}); scratchCanvas.addEventListener('touchend', end);
                scratchCanvas.addEventListener('touchmove', scratch, {passive:false});
                setupCanvas();
            }

            verifyPasswordButton.addEventListener('click', () => {
                if (passwordInput.value.trim().toUpperCase() === 'X5') {
                    passwordError.classList.add('hidden'); // Hide error if previously shown
                    scratchCardContainer.classList.add('hidden');
                    setAriaHidden(scratchCardContainer, true);
                    memberFormContainer.classList.remove('hidden');
                    setAriaHidden(memberFormContainer, false);
                    memberFormContainer.classList.add('fade-in'); // Add fade-in animation
                } else {
                    passwordError.classList.remove('hidden');
                }
            });

            // Form Submission Logic
            socialMediaYes.addEventListener('change', () => { socialMediaInputContainer.classList.remove('hidden'); socialMediaInputContainer.querySelector('input').required = true; });
            socialMediaNo.addEventListener('change', () => { socialMediaInputContainer.classList.add('hidden'); socialMediaInputContainer.querySelector('input').required = false; });
            memberForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                submitButton.disabled = true; buttonText.textContent = 'Mengirim...'; loadingSpinner.classList.remove('hidden');
                const formData = new FormData(memberForm);
                const data = Object.fromEntries(formData.entries());
                data.type = 'registration';
                if (data.hasSocialMedia === 'Tidak') data.sosialMediaName = 'Tidak ada';
                
                try {
                    await fetch(googleAppsScriptURL, { method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                    const testerName = data.tester;
                    const qrValue = `https://wa.me/${testerData[testerName]}`;
                    const successMessage = `Terima kasih, <strong>${data.namaPanggilan}</strong>! Data Anda berhasil dikirim. Silakan scan QR ini untuk menghubungi tester kalian.`;
                    
                    notificationModal.title.textContent = 'Pendaftaran Berhasil!';
                    notificationModal.message.innerHTML = successMessage;
                    notificationModal.qrContainer.innerHTML = '';
                    const qrCanvas = document.createElement('canvas');
                    notificationModal.qrContainer.appendChild(qrCanvas);
                    new QRious({ element: qrCanvas, value: qrValue, size: 200 });
                    notificationModal.downloadBtn.href = qrCanvas.toDataURL('image/png');
                    notificationModal.downloadBtn.download = `qr-code-x5-${data.namaPanggilan}.png`;
                    notificationModal.downloadBtn.classList.remove('hidden');
                    notificationModal.overlay.classList.add('show');
                    setAriaHidden(notificationModal.overlay, false);
                    memberFormContainer.classList.add('hidden');
                    setAriaHidden(memberFormContainer, true);
                } catch (error) {
                    console.error('Error submitting form:', error);
                    notificationModal.title.textContent = 'Terjadi Kesalahan';
                    notificationModal.message.innerHTML = 'Maaf, data Anda gagal dikirim. Silakan coba lagi nanti.';
                    notificationModal.overlay.classList.add('show');
                    setAriaHidden(notificationModal.overlay, false);
                } finally {
                    submitButton.disabled = false; buttonText.textContent = 'Kirim Data'; loadingSpinner.classList.add('hidden');
                }
            });
            notificationModal.resetBtn.addEventListener('click', () => {
                notificationModal.overlay.classList.remove('show');
                setAriaHidden(notificationModal.overlay, true);
                showMainMenu();
            });
        }

        // --- Main Menu Event Listeners ---
        isiBiodataBtn.addEventListener('click', showForm);
        
        // Function to show the "Coming Soon" modal
        const showComingSoonModal = () => {
            comingSoonModalOverlay.classList.add('show');
            setAriaHidden(comingSoonModalOverlay, false);
        };

        websiteBtn.addEventListener('click', showComingSoonModal);
        
        // Change Nickname Modal Logic (FIXED)
        const testerSelectChangeNick = document.getElementById('testerSelectChangeNick');
        const changeNickQrSection = document.getElementById('changeNickQrSection');
        const changeNickQrContainer = document.getElementById('changeNickQrContainer');
        const downloadChangeNickQrBtn = document.getElementById('downloadChangeNickQrBtn');
        Object.keys(testerData).forEach(name => {
            const option = document.createElement('option');
            option.value = name; option.textContent = name;
            testerSelectChangeNick.appendChild(option);
        });
        
        changeNickBtn.addEventListener('click', () => {
            testerSelectChangeNick.value = '';
            changeNickQrSection.classList.add('hidden');
            changeNickModalOverlay.classList.add('show');
            setAriaHidden(changeNickModalOverlay, false);
        });
        testerSelectChangeNick.addEventListener('change', function() {
            const testerName = this.value;
            if (!testerName) {
                changeNickQrSection.classList.add('hidden');
                return;
            }
            const phone = testerData[testerName];
            const message = encodeURIComponent("halo saya ingin meganti nickname.\n\nNick Awal :\nNick Ganti :\n\nTerimakasih");
            const qrValue = `https://wa.me/${phone}?text=${message}`;
            
            changeNickQrContainer.innerHTML = '';
            const qrCanvas = document.createElement('canvas');
            changeNickQrContainer.appendChild(qrCanvas);
            new QRious({ element: qrCanvas, value: qrValue, size: 160 }); // Adjusted size for layout

            downloadChangeNickQrBtn.href = qrCanvas.toDataURL('image/png');
            downloadChangeNickQrBtn.download = `qr-ganti-nick-${testerName}.png`;
            
            changeNickQrSection.classList.remove('hidden');
        });

        // Modal Close Buttons and Outside Click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', function(e) {
                if (e.target === this) { // Only close if click is directly on the overlay
                    this.classList.remove('show');
                    setAriaHidden(this, true); // Hide for accessibility
                }
            });
            // Also attach to the close button inside the modal
            const closeBtn = overlay.querySelector('.modal-close-btn');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    overlay.classList.remove('show');
                    setAriaHidden(overlay, true);
                });
            }
        });

        // Add ripple effect to all buttons
        document.querySelectorAll('.btn').forEach(button => {
            button.addEventListener('click', function(e) {
                // Ensure ripple effect doesn't happen on disabled buttons
                if (this.disabled) return;

                const x = e.clientX - e.target.getBoundingClientRect().left; // Use getBoundingClientRect for accurate position
                const y = e.clientY - e.target.getBoundingClientRect().top;
                const ripple = document.createElement('span');
                ripple.style.left = x + 'px';
                ripple.style.top = y + 'px';
                ripple.classList.add('ripple');
                this.appendChild(ripple);
                ripple.addEventListener('animationend', function() {
                    this.remove();
                });
            });
        });
    });
    </script>
</body>
</html>
